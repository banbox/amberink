module.exports = class Data1766988630481 {
    name = 'Data1766988630481'

    async up(db) {
        await db.query(`CREATE TABLE "comment" ("id" character varying NOT NULL, "comment_id" numeric NOT NULL, "content" text NOT NULL, "parent_comment_id" numeric, "likes" integer NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "tx_hash" text NOT NULL, "article_id" character varying, "user_id" character varying, CONSTRAINT "PK_0b0e4bbc8415ec426f87f3a88e2" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_03a590c26b0910b0bb49682b1e" ON "comment" ("article_id") `)
        await db.query(`CREATE INDEX "IDX_bbfe153fa60aa06483ed35ff4a" ON "comment" ("user_id") `)
        await db.query(`CREATE TABLE "evaluation" ("id" character varying NOT NULL, "score" integer NOT NULL, "amount" numeric NOT NULL, "comment" text, "referrer" text, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "tx_hash" text NOT NULL, "article_id" character varying, "user_id" character varying, CONSTRAINT "PK_b72edd439b9db736f55b584fa54" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_677620ead71939863f7450a37a" ON "evaluation" ("article_id") `)
        await db.query(`CREATE INDEX "IDX_764ed32806129494bb33086607" ON "evaluation" ("user_id") `)
        await db.query(`CREATE TABLE "collection" ("id" character varying NOT NULL, "token_id" numeric NOT NULL, "amount" numeric NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "tx_hash" text NOT NULL, "user_id" character varying, "article_id" character varying, CONSTRAINT "PK_ad3f485bbc99d875491f44d7c85" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_4f925485b013b52e32f43d430f" ON "collection" ("user_id") `)
        await db.query(`CREATE INDEX "IDX_27cfffb5c2f57530d9eb459ff1" ON "collection" ("article_id") `)
        await db.query(`CREATE TABLE "article" ("id" character varying NOT NULL, "article_id" numeric NOT NULL, "original_author" text, "title" text NOT NULL, "summary" text, "category_id" numeric NOT NULL, "royalty_bps" integer NOT NULL, "collect_price" numeric NOT NULL, "max_collect_supply" numeric NOT NULL, "collect_count" numeric NOT NULL, "originality" integer NOT NULL, "total_tips" numeric NOT NULL, "like_amount" numeric NOT NULL, "dislike_amount" numeric NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "edited_at" TIMESTAMP WITH TIME ZONE, "block_number" integer NOT NULL, "tx_hash" text NOT NULL, "author_id" character varying, CONSTRAINT "PK_40808690eb7b915046558c0f81b" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_16d4ce4c84bd9b8562c6f39626" ON "article" ("author_id") `)
        await db.query(`CREATE TABLE "follow" ("id" character varying NOT NULL, "is_active" boolean NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL, "follower_id" character varying, "following_id" character varying, CONSTRAINT "PK_fda88bc28a84d2d6d06e19df6e5" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_e65ef3268d3d5589f94b09c237" ON "follow" ("follower_id") `)
        await db.query(`CREATE INDEX "IDX_7e66760f06ef2ca5eb43109d1c" ON "follow" ("following_id") `)
        await db.query(`CREATE TABLE "user" ("id" character varying NOT NULL, "nickname" text, "avatar" text, "bio" text, "total_articles" integer NOT NULL, "total_followers" integer NOT NULL, "total_following" integer NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "profile_updated_at" TIMESTAMP WITH TIME ZONE, "session_key" text, CONSTRAINT "PK_cace4a159ff9f2512dd42373760" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "transaction" ("id" character varying NOT NULL, "session_key" text NOT NULL, "target" text NOT NULL, "method" text NOT NULL, "value" numeric NOT NULL, "fee_amount" numeric NOT NULL, "block_number" integer NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "tx_hash" text NOT NULL, "user_id" character varying, CONSTRAINT "PK_89eadb93a89810556e1cbcd6ab9" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_b4a3d92d5dde30f3ab5c34c586" ON "transaction" ("user_id") `)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_03a590c26b0910b0bb49682b1e3" FOREIGN KEY ("article_id") REFERENCES "article"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_bbfe153fa60aa06483ed35ff4a7" FOREIGN KEY ("user_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "evaluation" ADD CONSTRAINT "FK_677620ead71939863f7450a37a8" FOREIGN KEY ("article_id") REFERENCES "article"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "evaluation" ADD CONSTRAINT "FK_764ed32806129494bb330866071" FOREIGN KEY ("user_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collection" ADD CONSTRAINT "FK_4f925485b013b52e32f43d430f6" FOREIGN KEY ("user_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collection" ADD CONSTRAINT "FK_27cfffb5c2f57530d9eb459ff16" FOREIGN KEY ("article_id") REFERENCES "article"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "article" ADD CONSTRAINT "FK_16d4ce4c84bd9b8562c6f396262" FOREIGN KEY ("author_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "follow" ADD CONSTRAINT "FK_e65ef3268d3d5589f94b09c2373" FOREIGN KEY ("follower_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "follow" ADD CONSTRAINT "FK_7e66760f06ef2ca5eb43109d1cc" FOREIGN KEY ("following_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transaction" ADD CONSTRAINT "FK_b4a3d92d5dde30f3ab5c34c5862" FOREIGN KEY ("user_id") REFERENCES "user"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "comment"`)
        await db.query(`DROP INDEX "public"."IDX_03a590c26b0910b0bb49682b1e"`)
        await db.query(`DROP INDEX "public"."IDX_bbfe153fa60aa06483ed35ff4a"`)
        await db.query(`DROP TABLE "evaluation"`)
        await db.query(`DROP INDEX "public"."IDX_677620ead71939863f7450a37a"`)
        await db.query(`DROP INDEX "public"."IDX_764ed32806129494bb33086607"`)
        await db.query(`DROP TABLE "collection"`)
        await db.query(`DROP INDEX "public"."IDX_4f925485b013b52e32f43d430f"`)
        await db.query(`DROP INDEX "public"."IDX_27cfffb5c2f57530d9eb459ff1"`)
        await db.query(`DROP TABLE "article"`)
        await db.query(`DROP INDEX "public"."IDX_16d4ce4c84bd9b8562c6f39626"`)
        await db.query(`DROP TABLE "follow"`)
        await db.query(`DROP INDEX "public"."IDX_e65ef3268d3d5589f94b09c237"`)
        await db.query(`DROP INDEX "public"."IDX_7e66760f06ef2ca5eb43109d1c"`)
        await db.query(`DROP TABLE "user"`)
        await db.query(`DROP TABLE "transaction"`)
        await db.query(`DROP INDEX "public"."IDX_b4a3d92d5dde30f3ab5c34c586"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_03a590c26b0910b0bb49682b1e3"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_bbfe153fa60aa06483ed35ff4a7"`)
        await db.query(`ALTER TABLE "evaluation" DROP CONSTRAINT "FK_677620ead71939863f7450a37a8"`)
        await db.query(`ALTER TABLE "evaluation" DROP CONSTRAINT "FK_764ed32806129494bb330866071"`)
        await db.query(`ALTER TABLE "collection" DROP CONSTRAINT "FK_4f925485b013b52e32f43d430f6"`)
        await db.query(`ALTER TABLE "collection" DROP CONSTRAINT "FK_27cfffb5c2f57530d9eb459ff16"`)
        await db.query(`ALTER TABLE "article" DROP CONSTRAINT "FK_16d4ce4c84bd9b8562c6f396262"`)
        await db.query(`ALTER TABLE "follow" DROP CONSTRAINT "FK_e65ef3268d3d5589f94b09c2373"`)
        await db.query(`ALTER TABLE "follow" DROP CONSTRAINT "FK_7e66760f06ef2ca5eb43109d1cc"`)
        await db.query(`ALTER TABLE "transaction" DROP CONSTRAINT "FK_b4a3d92d5dde30f3ab5c34c5862"`)
    }
}
